<!doctype html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Партнёры</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/func-menus-style.css') }}">
    <script src="{{ url_for('static', filename='js/friends.js') }}"></script>
</head>
<body>
{% set current_friends = request.args.get('friends') %}
    <div class="sidebar">
        <h2>Фракции</h2>
        <ul class="sidebar-list">
            <li class="exit-button">
                <a href="{{ url_for('index') }}">В главное меню</a>
            </li>
            <li class="complete-buttons">
                <form method="post" action="{{ url_for('friends_stats.complete_all') }}">
                    <button type="submit" class="complete-all-button">Выполнить всё</button>
                </form>
                <form method="post" action="{{ url_for('friends_stats.disable_all') }}">
                    <button type="submit" class="complete-all-button">Провалить всё</button>
                </form>
            </li>
            {% for friends in all_certain %}
                {% set count = summary[friends] %}
                    <li class="{% if friends == current_friends %}active{% endif %}">
                        <a href="?friends={{ friends }}">
                            {{ friends }}
                            <span class="column-content-count {% if count.completed == count.total %}completed{% endif %}">
                                {{ count.completed }} / {{ count.total }}
                            </span>
                        </a>
                    </li>
            {% endfor %}
        </ul>
    </div>

    <div class="content">
        <h1 class="main-panel-title">Партнёры</h1>

        <div class="one-columns">
            <div class="column">
                {% for ach in all_data if not current_friends or ach.friends_fraction == current_friends %}
                    <form method="post" action="{{ url_for('friends_stats.update_status') }}">
                        <input type="hidden" name="friends_id" value="{{ ach.friends_id }}">
                        <button type="submit" class="column-content-btn">
                            <div class="column-content {{ 'ach-completed' if ach.friends_status == 'Максимальное доверие' }}">
                                <div class="column-content-info">
                                    <strong>{{ ach.friends_name }}</strong>
                                </div>
                                <span class="status {{ 'completed' if ach.friends_status == 'Максимальное доверие' else 'not-completed' }}">
                                    {{ ach.friends_status }}
                                </span>
                            </div>
                        </button>
                    </form>
                {% endfor %}
            </div>
         </div>
     </div>
</body>
</html>
